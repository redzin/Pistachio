#pragma once
#include "pch.h"

namespace Pistachio
{

  uint32_t NonZeroBitCount(uint32_t n)
  {
    static const std::array<uint32_t, 32> lookup =
    {
      0b00000000000000000000000000000001,
      0b00000000000000000000000000000010,
      0b00000000000000000000000000000100,
      0b00000000000000000000000000001000,
      0b00000000000000000000000000010000,
      0b00000000000000000000000000100000,
      0b00000000000000000000000001000000,
      0b00000000000000000000000010000000,
      0b00000000000000000000000100000000,
      0b00000000000000000000001000000000,
      0b00000000000000000000010000000000,
      0b00000000000000000000100000000000,
      0b00000000000000000001000000000000,
      0b00000000000000000010000000000000,
      0b00000000000000000100000000000000,
      0b00000000000000001000000000000000,
      0b00000000000000010000000000000000,
      0b00000000000000100000000000000000,
      0b00000000000001000000000000000000,
      0b00000000000010000000000000000000,
      0b00000000000100000000000000000000,
      0b00000000001000000000000000000000,
      0b00000000010000000000000000000000,
      0b00000000100000000000000000000000,
      0b00000001000000000000000000000000,
      0b00000010000000000000000000000000,
      0b00000100000000000000000000000000,
      0b00001000000000000000000000000000,
      0b00010000000000000000000000000000,
      0b00100000000000000000000000000000,
      0b01000000000000000000000000000000,
      0b10000000000000000000000000000000
    };

    uint32_t sum = 0;
    for (uint32_t i = 0; i < 32; i++)
      sum += i & lookup[i];

    return sum;
  }

}
